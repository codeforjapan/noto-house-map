(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{388:function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_ICON_COLOR",(function(){return m})),r.d(t,"default",(function(){return f})),r.d(t,"readCategoryOfFolder",(function(){return v})),r.d(t,"groupByCoordinates",(function(){return y}));var o=r(9),n=r(177),l=r(178),c=(r(25),r(12),r(21),r(31),r(176),r(20),r(35),r(30),r(48),r(110),r(249),r(174)),d=r(416),m="lightgreen",f=function(){function e(){Object(n.a)(this,e),this.updated=void 0,this.markers=void 0}return Object(l.a)(e,[{key:"parse",value:function(e,data,t,r,o){switch(e){case"kml":var n=(new DOMParser).parseFromString(data,"text/xml");return this.loadKMLData(n,t);case"umal":this.loadUmapJsonData(data);break;case"geojson":var l=JSON.parse(data);return this.loadGeoJSONData(l);case"xlsx":return this.loadXLSJsonData(data,r,o)}}},{key:"addFeatureCollection",value:function(e,t){e.features.forEach((function(e){e.geometry.type}))}},{key:"loadUmapJsonData",value:function(data){data.layers.forEach((function(e){}))}},{key:"loadXLSJsonData",value:function(data,e,t){var r=Date.now().toLocaleString(),o=[];return data.forEach((function(r){var n=Object.prototype.hasOwnProperty.call(r,"Latitude")?r.Latitude:Object.prototype.hasOwnProperty.call(r,"緯度")?r.緯度:void 0,l=Object.prototype.hasOwnProperty.call(r,"Longitude")?r.Longitude:Object.prototype.hasOwnProperty.call(r,"経度")?r.経度:void 0;if(void 0!==n&&void 0!==l){r.name=r[t];var c={type:"Feature",properties:r,geometry:{type:"Point",coordinates:[l,n]}},d="未分類";d=c.properties[e]?c.properties[e]:"未分類",o.push({feature:c,category:d})}})),[o,r]}},{key:"loadGeoJSONData",value:function(data){var e=Date.now().toLocaleString(),t=[];return data.features.forEach((function(e){var r="未分類";e.properties.category&&(r=e.properties.category),t.push({feature:e,category:r})})),[t,e]}},{key:"loadKMLData",value:function(data,e){var t=data.getElementsByTagName("Folder");0===t.length&&(t=data.getElementsByTagName("Document"));var r="";if(void 0!==e&&"regexp"===e.type){var o=data.getElementsByTagName(e.field);if(o.length>0){var text=o[0].innerHTML,n=new RegExp(e.pattern,"iu").exec(text);null!=n&&n.length>1&&(r="("+n[e.index]+")")}}var l=[];return Array.prototype.forEach.call(t,(function(e){var t=v(e,data);if("FeatureCollection"===d.kml(e).type){var r=d.kml(e,{styles:!0});if(r.features.length>0)return r.features.map((function(e){return"Point"===e.geometry.type&&(e.properties["marker-color"]=t.color,l.push({feature:e,category:t.name})),e}))}else{var o=d.kml(e,{styles:!0});o.properties["marker-color"]=t.color,l.push({geojsondata:o,category:t.name})}})),[l,r]}},{key:"inBounds",value:function(e,t){var r=(e[0]-t.getNorthEast().lng)*(e[0]-t.getSouthWest().lng)<0,o=(e[1]-t.getNorthEast().lat)*(e[1]-t.getSouthWest().lat)<0;return r&&o}},{key:"convertCategoryStyle",value:function(e,t){return void 0===t||t.forEach((function(t){if(t.name===e.name)return e.color=t.color,e.bgColor=t.bg_color,e.iconClass=t.icon_class,e.class=t.class,e})),e}},{key:"serializeLatLng",value:function(e){return e.lat+","+e.lng}},{key:"serializeBounds",value:function(e){return this.serializeLatLng(e.getNorthWest())+"-"+this.serializeLatLng(e.getSouthEast())}},{key:"deserializeLatLng",value:function(s){var e=s.split(",",2),t=Object(o.a)(e,2),r=t[0],n=t[1],l=parseFloat(n),d=parseFloat(r);return new c.LngLat(l,d)}},{key:"deserializeBounds",value:function(s){try{var e=this;return new c.LngLatBounds(s.split("-",2).map((function(t){return e.deserializeLatLng(t)})))}catch(e){return}}}]),e}();function v(e,t){var r,o="red";try{r=e.getElementsByTagName("name")[0].textContent||"";var n=e.getElementsByTagName("styleUrl")[0].textContent||"";if(n){var l=t.querySelectorAll(n+" Pair");l.length>0&&Array.prototype.forEach.call(l,(function(e){var r=e.querySelector("key");if(r&&"normal"===r.textContent){var n=e.querySelector("styleUrl").textContent,style=t.querySelector(n);try{var l=style.querySelector("IconStyle color").textContent,a=parseInt("0x"+l.substring(0,2))/255,b=parseInt("0x"+l.substring(2,4)),g=parseInt("0x"+l.substring(4,6)),c=parseInt("0x"+l.substring(6,8));o="rgba(".concat(c,",").concat(g,",").concat(b,",").concat(a,")")}catch(e){o=m}}}))}}catch(t){console.log("#category read error"),console.log(t),console.log(e)}return{name:r,color:o,iconUrl:undefined}}function y(data){var e={};return data.forEach((function(t){var r=t.feature.geometry.coordinates.join(","),o={"管理番号":t.feature.properties["管理番号"],"階数":t.feature.properties["階数"],"部屋番号":t.feature.properties["部屋番号"],"家賃":t.feature.properties["家賃（円）"],"間取り":t.feature.properties["間取り"],"ペット 可否":t.feature.properties["ペット 可否"],"駐車料":t.feature.properties["駐車料（円）"]};if(e[r])e[r].feature.properties.rooms.push(o);else{var n=JSON.parse(JSON.stringify(t));n.feature.properties.rooms=[o],delete n.feature.properties["管理番号"],delete n.feature.properties["階数"],delete n.feature.properties["部屋番号"],delete n.feature.properties["家賃（円）"],delete n.feature.properties["間取り"],delete n.feature.properties["ペット 可否"],delete n.feature.properties["駐車料（円）"],e[r]=n}})),Object.values(e)}},428:function(e,t,r){"use strict";r.r(t);r(31),r(48),r(41),r(402),r(12);var o,n=r(9),l=r(6),c=(r(58),r(27),r(405),r(407),r(30),r(55),r(59),r(21),r(138),r(25),r(35),r(384),r(385),r(174)),d=r.n(c),m=r(383),f=r(410).crc16,v={props:{mapConfig:{type:Object,required:!0}},data:function(){var e="en";return"ja"===this.$i18n.locale&&(e="ja"),{layers:[],map:null,bounds:null,updated_at:null,previous_hash:"",activeCategory:"",checkedArea:[],isOpenAreaSelect:!1,isOpenList:!0,isDisplayAllCategory:!0,mapStyle:"https://tile.openstreetmap.jp/styles/maptiler-basic-ja/style.json",legendMark:r(386)("./fukidashi_obj_".concat(e,".svg")),legendActive:r(387)("./active_txt_".concat(e,".svg"))}},computed:{center:function(){return this.mapConfig.center},setLayerSettings:function(e,t,r,o){var n=this.mapConfig;return n.layer_settings[e]={color:t,bg_color:r},o&&(n.layer_settings[e].icon_class=o),this.$emit("update:mapConfig",n),n},inBoundsMarkers:function(){var e=this,t=this.layers.filter((function(t){return t.source.show&&e.checkedArea.includes(t.source.title)})).map((function(e){return e.markers})).flat().filter((function(marker){return!e.bounds||o.inBounds(marker.feature.geometry.coordinates,e.bounds)}));return t},displayMarkersGroupByCategory:function(){var e=this.inBoundsMarkers.reduce((function(e,t){return t.feature.properties.rooms.map((function(e){return{category:t.category,feature:t.feature,room:e}})).forEach((function(t){var r=e.find((function(g){return g.category===t.category}));r||(r={category:t.category,prop:t.category,markers:[]},e.push(r)),r.markers.push(t)})),e}),[]);return console.log(e),e},selectArea:{get:function(){return this.checkedArea},set:function(e){this.checkedArea=e}}},mounted:function(){var e=this,t=r(388).default,c=r(388).groupByCoordinates,d=new(0,r(390).default);o=new t;var area=[],v={},y=this;this.mapConfig.sources.forEach((function(source){Object(l.a)(regeneratorRuntime.mark((function t(){var data,r,l,h,C;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return source.show&&area.push(source.title),y.checkedArea=area,y.updated_at=Object(m.a)(new Date),t.next=5,d.load(source);case 5:data=t.sent,r=o.parse(source.type,data,source.updated_search_key,source.categoryColumn,source.nameColumn),l=Object(n.a)(r,2),h=l[0],C=l[1],h.map((function(marker){v[marker.category]=!0})),source.updated_at=C,Object.keys(v).map((function(t){if(!y.mapConfig.layer_settings[t]){var r="#";r+=(parseInt(f(t.substr(0)),16)%32+64).toString(16),r+=(parseInt(f(t.substr(1)),16)%32+64).toString(16),r+=(parseInt(f(t.substr(2)),16)%32+64).toString(16);var o="#";o+=(parseInt(f(t.substr(0)),16)%32+128).toString(16),o+=(parseInt(f(t.substr(1)),16)%32+128).toString(16),o+=(parseInt(f(t.substr(2)),16)%32+128).toString(16),e.$emit("setLayerSettings",{name:t,color:r,bg_color:o})}})),y.layers.push({source:source,markers:c(h)});case 11:case"end":return t.stop()}}),t)})))()}))},methods:{load:function(){var e=window.location.hash.substr(1),t=o.deserializeBounds(e);this.map=this.$refs.map_obj,(void 0!==t||void 0!==(t=o.deserializeBounds(this.mapConfig.default_hash)))&&this.map.map.fitBounds(t,{linear:!1}),this.map.map.on("moveend",this.etmitBounds),this.etmitBounds(),this.map.map.addControl(new d.a.NavigationControl)},etmitBounds:function(){this.bounds=this.map.map.getBounds(),this.setHash(this.bounds),this.$emit("bounds-changed")},setHash:function(e){var s=o.serializeBounds(e),path=location.pathname;s!==this.previous_hash&&window.history.pushState("","",path+"#"+s),this.previous_hash=s},selectCategory:function(e){this.activeCategory=e},clickPrintButton:function(){window.print()},getMarkerCategoryText:function(e,t){void 0===e&&(e="未分類");var r="category."+e,o=this.$i18n.t(r);return o!==r?o:e},getMarkerNameText:function(e,t){var r=e.name;return e.hasOwnProperty("name:"+t)&&(r=e["name:"+t]),r},findNumbersOfMarker:function(e,marker){for(var i=0;i<e.length;i++){var t=e[i];if(t.feature.geometry.coordinates[0]===marker.feature.geometry.coordinates[0]&&t.feature.geometry.coordinates[1]===marker.feature.geometry.coordinates[1])return i+1}return 0}}},y=r(36),h=Object(y.a)(v,(function(){var e=this,t=e._self._c;return t("div",[t("client-only",[e.layers.length?t("div",[t("div",{staticClass:"map-outer"},[t("MglMap",{ref:"map_obj",attrs:{mapStyle:e.mapStyle,center:e.center,zoom:15,preserveDrawingBuffer:"",sourceId:"basemap",id:"map"},on:{"update:mapStyle":function(t){e.mapStyle=t},"update:map-style":function(t){e.mapStyle=t},load:e.load}},[t("MglGeolocateControl"),e._l(e.inBoundsMarkers,(function(marker,r){var o,n,l,c,d,m,f,v,y;return t("MglMarker",{key:String(r),attrs:{coordinates:marker.feature.geometry.coordinates,anchor:"top-left"}},[t("template",{slot:"marker"},[t("div",{staticClass:"marker"},[t("span",{class:{show:e.isDisplayAllCategory||e.activeCategory===marker.category},style:{background:(null===(o=e.mapConfig.layer_settings[marker.category])||void 0===o?void 0:o.color)||marker.feature.properties["marker-color"]||"red"}},[t("i",{class:[null===(n=e.mapConfig.layer_settings[marker.category])||void 0===n?void 0:n.icon_class,null===(l=e.mapConfig.layer_settings[marker.category])||void 0===l?void 0:l.class],style:{backgroundColor:null===(c=e.mapConfig.layer_settings[marker.category])||void 0===c?void 0:c.color,display:e.mapConfig.layer_settings[marker.category]?"inline":"none"}}),t("b",{staticClass:"number",style:{background:null===(d=e.mapConfig.layer_settings[marker.category])||void 0===d?void 0:d.bg_color}},[e._v(e._s(r+1))])])])]),t("MglPopup",[t("div",{staticClass:"popup-window"},[t("div",{staticClass:"popup-type"},[t("i",{class:[null===(m=e.mapConfig.layer_settings[marker.category])||void 0===m?void 0:m.icon_class,null===(f=e.mapConfig.layer_settings[marker.category])||void 0===f?void 0:f.class],style:{backgroundColor:null===(v=e.mapConfig.layer_settings[marker.category])||void 0===v?void 0:v.color}}),t("span",{staticClass:"popup-poi-type"},[e._v(e._s(e.getMarkerCategoryText((null===(y=e.mapConfig.layer_settings[marker.category])||void 0===y?void 0:y.name)||marker.category,e.$i18n.locale)))])]),t("p",{staticClass:"popup-detail"},[e._v(e._s(e.$i18n.t("PrintableMap.name"))+" "),marker.feature.properties.rooms.length>1?t("span",[e._v(e._s(e.getMarkerNameText(marker.feature.properties,e.$i18n.locale)))]):t("span",[t("nuxt-link",{attrs:{to:e.localePath("/detail/".concat(marker.feature.properties.rooms[0]["管理番号"]))}},[e._v(e._s(e.getMarkerNameText(marker.feature.properties,e.$i18n.locale)))])],1)]),e._l(marker.feature.properties.rooms,(function(r){return t("div",{staticClass:"list-item grid-noGutter"},[t("div",{staticClass:"col-4"},[t("nuxt-link",{attrs:{to:e.localePath("/detail/".concat(r["管理番号"]))}},[t("span",{staticClass:"item-name"},[e._v(e._s("-"===r["部屋番号"]?"詳細":r["部屋番号"]))])])],1),t("div",{staticClass:"col-4"},[t("span",{staticClass:"item-price"},[e._v(e._s(r["間取り"]))])]),t("div",{staticClass:"col-4"},[t("span",{staticClass:"item-price"},[e._v(e._s(r["家賃"]))])])])}))],2)])],2)}))],2)],1),t("div",{staticClass:"legend-navi"},[t("div",{staticClass:"area-select",class:{open:e.isOpenAreaSelect}},[t("div",{staticClass:"area-close",on:{click:function(t){e.isOpenAreaSelect=!1}}},[e._v(e._s(e.$t("PrintableMap.close_area_select"))),t("i",{staticClass:"fas fa-arrow-down"})]),t("div",{staticClass:"area-list-outer",class:{open:e.isOpenAreaSelect}},[t("ul",{staticClass:"area-list grid"},e._l(e.mapConfig.sources,(function(source){return t("li",{staticClass:"area-item col-12_xs-6"},[t("label",{staticClass:"area-label"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.selectArea,expression:"selectArea"}],staticClass:"area-input",attrs:{type:"checkbox"},domProps:{value:source.title,checked:Array.isArray(e.selectArea)?e._i(e.selectArea,source.title)>-1:e.selectArea},on:{change:function(t){var r=e.selectArea,o=t.target,n=!!o.checked;if(Array.isArray(r)){var l=source.title,c=e._i(r,l);o.checked?c<0&&(e.selectArea=r.concat([l])):c>-1&&(e.selectArea=r.slice(0,c).concat(r.slice(c+1)))}else e.selectArea=n}}}),e._v(e._s(source.title)),t("span",[e._v(e._s(source.updated_at))]),source.link?t("a",{attrs:{href:source.link,target:"blank"}},[e._v("["+e._s(e.$t("PrintableMap.back_to_map"))+"]")]):e._e()])])})),0)])]),t("div",{staticClass:"navigation"},[t("div",{staticClass:"navigation-legend legend-navi-inner print-exclude"},[t("div",{staticClass:"legend-navi-icon"},[t("img",{attrs:{src:e.legendMark,width:"60",height:"60",alt:e.$t("PrintableMap.legend")}})]),t("div",{staticClass:"legend-list-outer"},[t("simplebar",{attrs:{"data-simplebar-auto-hide":"false"}},[t("ul",{staticClass:"legend-list"},e._l(e.mapConfig.layer_settings,(function(r,o){return e.displayMarkersGroupByCategory.some((function(e){return e.category===o}))?t("li",{staticClass:"legend-item"},[t("span",{staticClass:"legend-mark",class:{open:e.isDisplayAllCategory||e.activeCategory===o},style:{backgroundColor:r.color},on:{click:function(t){e.selectCategory(o),e.isOpenList=o,e.isDisplayAllCategory=!1}}},[t("i",{class:[r.icon_class]})])]):e._e()})),0)])],1),t("div",{staticClass:"legend-navi-icon",class:{active:e.activeCategory},on:{click:function(t){e.selectCategory(""),e.isDisplayAllCategory=!0,e.isOpenList=!0}}},[t("div",{staticClass:"legend-navi-button"},[t("img",{staticClass:"legend-navi-img",attrs:{src:e.legendActive,width:"40",height:"40",alt:e.$t("PrintableMap.show_all")}})])])])]),t("div",{staticClass:"list-outer",class:{open:e.isOpenList}},[e._l(e.displayMarkersGroupByCategory,(function(r){var o,n,l,c;return t("section",{staticClass:"list-section",class:{show:e.isDisplayAllCategory||e.activeCategory===e.getMarkerCategoryText(r.category,e.$i18n.locale)}},[t("h2",{staticClass:"list-title",style:{backgroundColor:(null===(o=e.mapConfig.layer_settings[r.category])||void 0===o?void 0:o.color)||(null===(n=r.markers[0])||void 0===n||null===(n=n.feature)||void 0===n?void 0:n.properties["marker-color"])||"darkgreen"}},[t("span",{staticClass:"list-title-mark"},[t("i",{class:null===(l=e.mapConfig.layer_settings[r.category])||void 0===l?void 0:l.icon_class})]),t("span",[e._v(e._s(e.getMarkerCategoryText((null===(c=e.mapConfig.layer_settings[r.category])||void 0===c?void 0:c.name)||r.category,e.$i18n.locale)))])]),t("ul",{staticClass:"list-items"},[t("li",{staticClass:"list-item-header grid-noGutter"},[t("div",{staticClass:"col-1"},[t("div",{staticClass:"span"},[e._v("No.")])]),t("div",{staticClass:"col-3"},[t("div",{staticClass:"span"},[e._v("物件名")])]),t("div",{staticClass:"col-2"},[t("div",{staticClass:"span"},[e._v("間取り")])]),t("div",{staticClass:"col-2"},[t("div",{staticClass:"span"},[e._v("家賃")])]),t("div",{staticClass:"col-2"},[t("div",{staticClass:"span"},[e._v("所在地")])])]),e._l(r.markers,(function(marker,r){return t("li",{staticClass:"list-item grid-noGutter",class:{oddlist:r%2==0}},[t("div",{staticClass:"col-1"},[t("span",{staticClass:"item-number"},[e._v(e._s(e.findNumbersOfMarker(e.inBoundsMarkers,marker)))])]),t("div",{staticClass:"col-3"},[t("nuxt-link",{attrs:{to:e.localePath("/detail/".concat(marker.room["管理番号"]))}},[t("span",{staticClass:"item-name"},[e._v(e._s(e.getMarkerNameText(marker.feature.properties,e.$i18n.locale))+" "+e._s(marker.room["部屋番号"]))])])],1),t("div",{staticClass:"col-2"},[t("span",{staticClass:"item-price"},[e._v(e._s(marker.room["間取り"]))])]),t("div",{staticClass:"col-2"},[t("span",{staticClass:"item-price"},[e._v(e._s(marker.room["家賃"])+"円")])]),t("div",{staticClass:"col-2"},[t("span",{staticClass:"item-pet"},[e._v(e._s(marker.feature.properties["所在地"]))])])])}))],2)])})),e.isDisplayAllCategory&&0===e.displayMarkersGroupByCategory.length?t("div",{staticClass:"list-section-none"},[t("p",[e._v(e._s(e.$t("PrintableMap.no_point_in_map")))])]):e._e()],2)]),t("div",{staticClass:"legend-close print-exclude",class:{open:e.isOpenList},on:{click:function(t){e.isOpenList=!1}}},[e._v(e._s(e.$t("PrintableMap.close_list"))),t("i",{staticClass:"fas fa-arrow-down"})])]):e._e()])],1)}),[],!1,null,null,null).exports,C=r(400),_=r(401);r(399).init();var k={components:{PrintableMap:h,Modal:_.a,MyHeader:C.a},asyncData:function(e){var t=e.app.i18n.locale;return{updated_at:Object(m.a)(new Date,t)}},data:function(){return{mapConfig:r(382),locale:null,isOpenExplain:!1,fullURL:null,updated_at:null}},head:function(){var title,e,image=this.mapConfig.map_image?this.mapConfig.map_image:"logo.png";if("ja"===this.$i18n.locale)title=this.mapConfig.map_title,e=this.mapConfig.map_description;else title=this.mapConfig.map_title_en,e=this.mapConfig.map_description_en;return{title:title+" - "+this.$i18n.t("common.site_name"),meta:[{hid:"description",name:"description",content:e},{hid:"og:image",property:"og:image",content:"https://kamimap.com/images/"+image},{hid:"og:description",name:"og:description",content:e},{hid:"og:title",name:"og:title",content:title+this.$i18n.t("common.site_name")}]}},methods:{updateQRCode:function(){this.$refs.myHeader.updateQRCode()},closeModalMethod:function(){this.isOpenExplain=!1}}},w=Object(y.a)(k,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"layout-map"},[t("div",{staticClass:"layout-map-inner"},[t("main",{staticClass:"main col-12_md-9_xl-6"},[t("div",{staticClass:"main-sheet"},[t("my-header",{ref:"myHeader",attrs:{mapConfig:e.mapConfig}}),e.mapConfig?t("printable-map",{attrs:{mapConfig:e.mapConfig},on:{"bounds-changed":e.updateQRCode}}):e._e(),t("footer",{staticClass:"footer"},[t("div",{staticClass:"footer-logo"},[t("img",{attrs:{src:r(380),width:"895",height:"160",alt:e.$t("common.title")}})])])],1)])]),t("modal",{attrs:{isOpen:e.isOpenExplain},on:{closeModal:e.closeModalMethod}})],1)}),[],!1,null,null,null);t.default=w.exports}}]);